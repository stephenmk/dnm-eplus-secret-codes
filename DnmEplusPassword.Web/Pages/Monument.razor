@page "/monument"
@using DnmEplusPassword.Library.Data
@using DnmEplusPassword.Web.Components
@using DnmEplusPassword.Web.Models

<PageTitle>Monument Codes</PageTitle>

<h1>Monument Secret Code Generator</h1>

<EditForm Model="@Model" OnValidSubmit="GenerateSecretCode" OnInvalidSubmit="ClearSecretCode" style="max-width: 400px;">
    <DataAnnotationsValidator />

    <div class="row">
        <InputName Name="@Model.RecipientTownName" LabelText="Recipient's Town Name" />
        <InputName Name="@Model.RecipientName" LabelText="Recipient's Name" />
    </div>
    <div class="row">
        <InputDecoration Decoration="@Model.Decoration" />
        <InputPrice Price="@Model.Price" />
    </div>
    <div class="row">
        <InputPlacementAcre PlacementAcre="@Model.PlacementAcre" />
    </div>
    <InputLanguage Language="@Model.Language" />

    <button type="submit" class="btn btn-primary">Generate</button>
</EditForm>

@if (SecretCode is not null)
{
    <OutputSecretCode SecretCode="@SecretCode" />
}

@code {
    private MonumentCodeGenerator Model = new();
    private PasswordOutput? SecretCode = null;

    public void GenerateSecretCode()
    {
        try
        {
            SecretCode = Model.GenerateSecretCode();
        }
        catch
        {
            SecretCode = null;
        }
    }

    public void ClearSecretCode()
    {
        SecretCode = null;
    }
}
